# Instalacja i uruchomienie Lynis na RHEL 10

## 1. Wprowadzenie
**Lynis** to zaawansowane narzędzie typu *open-source* do audytu bezpieczeństwa systemów Linux, macOS i Unix.  
Pozwala ocenić konfigurację, wykryć luki bezpieczeństwa oraz wyliczyć tzw. **Hardening Index** – wskaźnik twardnienia systemu.

## 2. Wymagania
Do instalacji Lynisa potrzebne są:
- system RHEL 10 lub kompatybilny (AlmaLinux, Rocky Linux),
- uprawnienia administratora (root lub sudo),
- dostęp do Internetu (dla pobrania repozytorium CISOfy).

## 3. Instalacja krok po kroku

### Krok 1: Aktualizacja systemu i pakietów
```
sudo dnf update -y
sudo dnf install -y ca-certificates curl nss openssl
```

### Krok 2: Import klucza GPG CISOfy
```
sudo rpm --import https://packages.cisofy.com/keys/cisofy-software-rpms-public.key
```

### Krok 3: Dodanie repozytorium Lynis
```
sudo tee /etc/yum.repos.d/cisofy-lynis.repo > /dev/null <<'EOF'
[lynis]
name=CISOfy Software - Lynis package
baseurl=https://packages.cisofy.com/community/lynis/rpm/
enabled=1
gpgkey=https://packages.cisofy.com/keys/cisofy-software-rpms-public.key
gpgcheck=1
priority=2
EOF
```

### Krok 4: Instalacja Lynisa
```
sudo dnf makecache --refresh
sudo dnf install -y lynis
```

## 4. Weryfikacja instalacji
Po instalacji możesz sprawdzić wersję programu:
```
lynis show version
```

## 5. Uruchomienie audytu systemu

### Pełny audyt:
```
sudo lynis audit system
```

### Szybszy audyt (bez pauz):
```
sudo lynis audit system --quick
```

Podczas pierwszego uruchomienia Lynis może wyświetlić komunikat:
```
Translation file (db/languages/pl) needs an update [OUTDATED]
```
To **informacja**, nie błąd. Oznacza jedynie, że polskie tłumaczenie jest nieaktualne. Program przejdzie dalej automatycznie.

## 6. Wyniki i raporty
Po zakończeniu audytu wyniki znajdziesz w:
```
/var/log/lynis.log
/var/log/lynis-report.dat
```

W pliku `lynis-report.dat` znajdziesz m.in. wynik **Hardening Index**, który określa ogólny poziom bezpieczeństwa systemu (0–100).  
Przykład:
```
hardening_index=77
```

## 7. Typowe problemy

### Błąd z kluczem GPG
Jeśli pojawi się komunikat o błędzie weryfikacji GPG:
```
sudo rpm --import https://packages.cisofy.com/keys/cisofy-software-rpms-public.key
sudo dnf clean all
sudo dnf makecache --refresh
```

### Brak repozytorium lub połączenia z Internetem
Można zainstalować Lynis ręcznie z GitHuba:
```
sudo git clone https://github.com/CISOfy/lynis /usr/local/lynis
cd /usr/local/lynis
sudo ./lynis audit system
```

## 8. Podsumowanie
Lynis to lekkie, skuteczne narzędzie do oceny bezpieczeństwa serwerów Linux.  
Regularne uruchamianie audytów (np. co tydzień przez cron) pozwala utrzymać system w dobrej kondycji i szybko reagować na potencjalne luki.
